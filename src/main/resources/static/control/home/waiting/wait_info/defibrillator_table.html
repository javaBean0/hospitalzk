<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>除颤器质量检测原始记录表</title>
    <link rel="stylesheet" type="text/css" href="../../../../static/layui/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="../../../../static/css/admin.css"/>
    <script src="../../../../static/js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>
    <!--[if IE 8]>
    <script type="text/javascript" src="../../../../static/js/jquery-1.11.3.min.js"></script>
    <![endif]-->
    <script src="../../../../static/layui/layui.js"></script>
    <style>
        h2{
            text-align: center;
            margin-top: 30px;
        }
        td{
            text-align: center;
        }
        .btn{
            width: 100%;
            margin-top: 50px;
            margin-bottom: 30px;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="layui-row">
    <div class="col-xs-12">
        <fieldset class="layui-elem-field layui-field-title">
            <legend style="color: #000000;font-weight: bold;text-align: center;margin-bottom: 30px;">除颤器质量检测原始记录表</legend>
        </fieldset>
        <table class="layui-table">
            <tr>
                <td rowspan="6">释放能量(J)允许误差 ±15%或±4J<br>(取最大值)</td>
                <td>标称值</td>
                <td colspan="3">测量值</td>
                <td>误差</td>
                <td>标称值</td>
                <td colspan="3">测量值</td>
                <td>误差</td>
                <td>测试结果</td>
            </tr>
            <tr>
                <td id="zxnl">最小能量值:&nbsp;&nbsp;</td>
                <td id="sfnlValue1" colspan="3">&nbsp;</td>
                <td id="sfnlWc1">&nbsp;</td>
                <td id="zdnl">最大能量值:&nbsp;&nbsp;</td>
                <td id="sfnlValue6" colspan="3">&nbsp;</td>
                <td id="sfnlWc6">&nbsp;</td>
                <td rowspan="5" id="is1"></td>
            </tr>
            <tr>
                <td>30</td>
                <td id="sfnlValue2" colspan="3">&nbsp;</td>
                <td id="sfnlWc2">&nbsp;</td>
                <td>100</td>
                <td id="sfnlValue4" colspan="3">&nbsp;</td>
                <td id="sfnlWc4">&nbsp;</td>
            </tr>
            <tr>
                <td>50</td>
                <td id="sfnlValue3" colspan="3">&nbsp;</td>
                <td id="sfnlWc3">&nbsp;</td>
                <td>200</td>
                <td id="sfnlValue5" colspan="3">&nbsp;</td>
                <td id="sfnlWc5">&nbsp;</td>
            </tr>
            <tr>
                <td style="width: 9%;" rowspan="2">20</td>
                <td style="width: 7%;">前</td>
                <td style="width: 7%;">中</td>
                <td style="width: 7%;">后</td>
                <td id="sfnlWc7" style="width: 9%;" rowspan="2">&nbsp;</td>
                <td style="width: 9%;" rowspan="2">200</td>
                <td style="width: 7%;">前</td>
                <td style="width: 7%;">中</td>
                <td style="width: 7%;">后</td>
                <td id="sfnlWc8" style="width: 10%;" rowspan="2">&nbsp;</td>
            </tr>
            <tr>
                <td id="sfnlValue71">&nbsp;</td>
                <td id="sfnlValue72">&nbsp;</td>
                <td id="sfnlValue73">&nbsp;</td>
                <td id="sfnlValue81">&nbsp;</td>
                <td id="sfnlValue82">&nbsp;</td>
                <td id="sfnlValue83">&nbsp;</td>
            </tr>
            <tr>
                <td>充电时间(s)≤20s</td>
                <td id="cdsjValue" colspan="3">&nbsp;</td>
                <td id="is2" colspan="3"></td>
                <td colspan="2">内部放电</td>
                <td id="nbfdResult" colspan="3"></td>
            </tr>
            <tr>
                <td>同步模式</td>
                <td id="tbmsCfresult" colspan="4"></td>
                <td colspan="2">同步延迟时间（ms）:≤60ms</td>
                <td id="tbmsSj" colspan="2">&nbsp;</td>
                <td id="is3" colspan="3"></td>
            </tr>
            <tr>
                <td rowspan="2">心率示值</td>
                <td colspan="2">设定值</td>
                <td colspan="2">30(28～32)</td>
                <td>60(57～63)</td>
                <td>100(95～105)</td>
                <td colspan="2">120(114～126)</td>
                <td colspan="2">180(171～189)</td>
                <td>测试结果</td>
            </tr>
            <tr>
                <td colspan="2">测量值</td>
                <td id="xlszValue1" colspan="2">&nbsp;</td>
                <td id="xlszValue2">&nbsp;</td>
                <td id="xlszValue3">&nbsp;</td>
                <td id="xlszValue4" colspan="2">&nbsp;</td>
                <td id="xlszValue5" colspan="2">&nbsp;</td>
                <td id="is4"></td>
            </tr>
            <tr>
                <td>声光报警</td>
                <td id="sgbjResult" colspan="2"></td>
                <td colspan="2">报警限检查</td>
                <td id="bjxResult" colspan="2"></td>
                <td colspan="3">静音检查</td>
                <td id="jyResult" colspan="2"></td>
            </tr>
            <tr>
                <td>检测说明</td>
                <td id="jcsm" colspan="11">&nbsp;</td>
            </tr>
        </table>
        <fieldset class="layui-elem-field layui-field-title">
            <legend style="color: #000000;font-weight: bold;">检测人信息</legend>
        </fieldset>
        <table class="layui-hide" id="testerInfo"></table>
        <div class="col-xs-12 btn">
            <a id="update" class="layui-btn">修改</a>
            <a id="back" class="layui-btn">暂不上传</a>
            <button id="upload" class="layui-btn layui-btn-normal">上传</button>
        </div>
    </div>
</div>
<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
    </div>
</script>
<script>
    // 获取上个页面传递的类型
    var type = window.location.search;
    var ids = parseInt(type.split("=")[1]);
    var thissjId = parseInt(sessionStorage['thissjId']);
    var thisId = parseInt(sessionStorage['thisId']);
    var thiseqId = parseInt(sessionStorage['thiseqId']);
    $(function(){
        $.ajax({
            url:"/ccy/findByCcyIds?ccyId="+ids,
            method:"GET",
            dataType:"JSON",
            success:function(res){
                console.log(res);
                if(res.data != null && res.data != ""){
                    $("#zxnl").append(res.data.zxnl);
                    $("#zdnl").append(res.data.zdnl);
                    $("#sfnlValue1").append(res.data.sfnlValue1);
                    $("#sfnlWc1").append(res.data.sfnlWc1);
                    $("#sfnlValue2").append(res.data.sfnlValue2);
                    $("#sfnlWc2").append(res.data.sfnlWc2);
                    $("#sfnlValue3").append(res.data.sfnlValue3);
                    $("#sfnlWc3").append(res.data.sfnlWc3);
                    $("#sfnlValue4").append(res.data.sfnlValue4);
                    $("#sfnlWc4").append(res.data.sfnlWc4);
                    $("#sfnlValue5").append(res.data.sfnlValue5);
                    $("#sfnlWc5").append(res.data.sfnlWc5);
                    $("#sfnlValue6").append(res.data.sfnlValue6);
                    $("#sfnlWc6").append(res.data.sfnlWc6);
                    $("#sfnlValue71").append(res.data.sfnlValue71);
                    $("#sfnlValue72").append(res.data.sfnlValue72);
                    $("#sfnlValue73").append(res.data.sfnlValue73);
                    $("#sfnlWc7").append(res.data.sfnlWc7);
                    $("#sfnlValue81").append(res.data.sfnlValue81);
                    $("#sfnlValue82").append(res.data.sfnlValue82);
                    $("#sfnlValue83").append(res.data.sfnlValue83);
                    $("#sfnlWc8").append(res.data.sfnlWc8);
                    if(res.data.sfnlWc1 >= -0.15 && res.data.sfnlWc1 <= 0.15 && res.data.sfnlWc2 >= -0.15 && res.data.sfnlWc2 <= 0.15 && res.data.sfnlWc3 >= -0.15 && res.data.sfnlWc3 <= 0.15 && res.data.sfnlWc4 >= -0.15 && res.data.sfnlWc4 <= 0.15 && res.data.sfnlWc5 >= -0.15 && res.data.sfnlWc5 <= 0.15 && res.data.sfnlWc6 >= -0.15 && res.data.sfnlWc6 <= 0.15 && res.data.sfnlWc7 >= -0.15 && res.data.sfnlWc7 <= 0.15 && res.data.sfnlWc8 >= -0.15 && res.data.sfnlWc8 <= 0.15){
                        $("#is1").append("<p style='color:green;'>符合</p>");
                    }else{
                        $("#is1").append("<p style='color:red;'>不符合</p>")
                    }
                    // 充电时间
                    $("#cdsjValue").append(res.data.cdsjValue);
                    if(res.data.cdsjValue > 0 && res.data.cdsjValue <= 20){
                        $("#is2").append("<p style='color:green;'>符合</p>");
                    }else{
                        $("#is2").append("<p style='color:red;'>不符合</p>")
                    }
                    // 同步延迟时间
                    $("#tbmsSj").append(res.data.tbmsSj);
                    if(res.data.tbmsSj > 0 && res.data.tbmsSj <= 60){
                        $("#is3").append("<p style='color:green;'>符合</p>");
                    }else{
                        $("#is3").append("<p style='color:red;'>不符合</p>")
                    }
                    // 心率示值
                    $("#xlszValue1").append(res.data.xlszValue1);
                    $("#xlszValue2").append(res.data.xlszValue2);
                    $("#xlszValue3").append(res.data.xlszValue3);
                    $("#xlszValue4").append(res.data.xlszValue4);
                    $("#xlszValue5").append(res.data.xlszValue5);
                    if(res.data.xlszValue1 >= 28 && res.data.xlszValue1 <= 32 && res.data.xlszValue2 >= 57 && res.data.xlszValue2 <= 63 && res.data.xlszValue3 >= 95 && res.data.xlszValue3 <= 105 && res.data.xlszValue4 >= 114 && res.data.xlszValue4 <= 126 && res.data.xlszValue5 >= 171 && res.data.xlszValue5 <= 189){
                        $("#is4").append("<p style='color:green;'>符合</p>");
                    }else{
                        $("#is4").append("<p style='color:red;'>不符合</p>")
                    }
                    // 单选
                    if(res.data.nbfdResult == 1){
                        $("#nbfdResult").append("<p style='color: green;'>符合</p>");
                    }else{
                        $("#nbfdResult").append("<p style='color: red;'>不符合</p>");
                    }
                    if(res.data.tbmsCfresult == 1){
                        $("#tbmsCfresult").append("<p style='color: green;'>有同步触发功能</p>");
                    }else{
                        $("#tbmsCfresult").append("<p style='color: red;'>无同步触发功能</p>");
                    }
                    if(res.data.sgbjResult == 1){
                        $("#sgbjResult").append("<p style='color: green;'>符合</p>");
                    }else{
                        $("#sgbjResult").append("<p style='color: red;'>不符合</p>");
                    }
                    if(res.data.bjxResult == 1){
                        $("#bjxResult").append("<p style='color: green;'>符合</p>");
                    }else{
                        $("#bjxResult").append("<p style='color: red;'>不符合</p>");
                    }
                    if(res.data.jyResult == 1){
                        $("#jyResult").append("<p style='color: green;'>符合</p>");
                    }else{
                        $("#jyResult").append("<p style='color: red;'>不符合</p>");
                    }
                }
            }
        })
    });
    //Demo
    layui.use(['table','layer','jquery','form'],function(){
        var table = layui.table
            , layer = layui.layer
            , $ = layui.jquery
            , form = layui.form;
        table.render({
            elem:"#testerInfo",
            cellMinWidth:100,
            toolbar: '#toolbarDemo',
            url:"/ccy/findByCcyIds?ccyId="+ids,
            method:"GET",
            response: {
                statusName: 'status'
                ,statusCode: 200
                ,msgName: 'hint'
                ,countName: 'total'
                ,dataName: 'data'
            },
            parseData:function(res){
                console.log(res.data);
//                sessionStorage['lreqId'] = res.data.eqId;
                return{
                    "status":200
                    ,"msg":res.message
                    ,"count":res.total
                    ,"data":[res.data]
                }
            },
            cols:[[
                {field:'tester', title:'检测人',align:'center'},
                {field:'testTime', title:'检测时间',align:'center'},
                {field:'jcsm', title:'检测情况说明',align:'center'}
            ]]
        });
        // 上传
        $("#upload").click(function(){
            $.ajax({
                url:"/dqjc/updateState?yqEqId="+thissjId+"&userEqId="+thisId,
                method:"POST",
                success:function(res){
                    if(res.state === 200){
                        layer.msg("上传成功，请耐心等待管理员审核");
                        setTimeout(function(){
                            location.href="/control/home/waiting/check_info.html?id="+thiseqId;
                        },1000)
                    }else{
                        layer.msg("上传失败");
                    }
                },
                error:function(data){
                    layer.msg("上传失败,请稍后再试");
                    console.log(data);
                }
            })
        });
        // 修改
        $("#update").click(function(){
            location.href="/control/home/waiting/update/write_defibrillator_info.html?id="+ids;
        });
        // 返回
        $("#back").click(function () {
            location.href="/control/home/waiting/check_info.html?id="+thiseqId;
        })
    })
</script>
</body>

</html>